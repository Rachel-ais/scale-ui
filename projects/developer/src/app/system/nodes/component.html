<div class="nodes__title flexed">
    <h2><i class="fa fa-circle-o"></i> Nodes ({{ count }})</h2>
    <p-inputSwitch [(ngModel)]="showActive" [pTooltip]="activeLabel" (onChange)="toggleShowActive()"
                   styleClass="margin-left-sm"></p-inputSwitch>
</div>
<p-dataView [value]="nodes" layout="grid" [loading]="loading" styleClass="nodes__dataview">
    <ng-template let-node pTemplate="gridItem">
        <div class="ui-g-12 ui-md-4">
            <p-panel [styleClass]="node.headerClass">
                <p-header>
                    <div class="flexed space-between">
                        <div class="flexed">
                            <div>{{ node.hostname }}</div>
                            <div class="label margin-left-sm" [ngClass]="node.status.stateClass"
                                 [pTooltip]="node.status.state.description" *ngIf="node.status">
                                {{ node.status.state.title }}
                            </div>
                            <div class="margin-left-sm" *ngIf="node.status && node.status.errors.length > 0">
                                <span class="fa fa-exclamation-triangle error-text" [pTooltip]="node.status.errorTooltip"></span>
                            </div>
                            <div class="margin-left-sm" *ngIf="node.status && node.status.warnings.length > 0">
                                <span class="fa fa-exclamation-triangle warning-text"
                                      [pTooltip]="node.status.warningTooltip"></span>
                            </div>
                        </div>
                        <div>
                            <p-menu #menu [popup]="true" [model]="node.menuItems" appendTo="body"></p-menu>
                            <button pButton type="button" class="ui-button-secondary" icon="fa fa-bars"
                                    (click)="menu.toggle($event)"></button>
                        </div>
                    </div>
                </p-header>
                <div class="ui-g" *ngIf="node.status">
                    <div class="ui-g-6" *ngIf="node.status.jobExeData">
                        <p-chart type="bar" [data]="node.status.jobExeData" [options]="jobExeOptions"></p-chart>
                    </div>
                    <div class="ui-g-6" *ngIf="!node.status.jobExeData">
                        <span class="label label-info">No job executions during the past 3 hours</span>
                    </div>
                    <div class="ui-g-6" *ngIf="node.status.runningJobData.datasets[0].data.length > 0">
                        <p-chart type="doughnut" [data]="node.status.runningJobData" [options]="runningJobOptions"></p-chart>
                    </div>
                    <div class="ui-g-6" *ngIf="node.status.runningJobData.datasets[0].data.length === 0">
                        <span class="label label-info">No jobs are running on this node</span>
                    </div>
                </div>
            </p-panel>
        </div>
    </ng-template>
</p-dataView>
<p-dialog [(visible)]="pauseDisplay" [modal]="true" [dismissableMask]="true" *ngIf="nodeToPause">
    <p-header>
        <strong>Pause node</strong>
    </p-header>
    Specify a reason for pausing this node<br />
    <input id="input" type="text" size="30" pInputText [(ngModel)]="nodeToPause.pause_reason">
    <p-footer>
        <button pButton type="button" class="ui-button-danger" label="Cancel" icon="fa fa-remove"
                iconPos="right" (click)="pauseDisplay = false"></button>
        <button pButton type="button" class="ui-button-success" label="Continue" icon="fa fa-check"
                iconPos="right" (click)="updateNode(nodeToPause)"></button>
    </p-footer>
</p-dialog>
