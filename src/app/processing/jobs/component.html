<h2>Jobs</h2>
<p-dataTable [value]="jobs" [rows]="datatableOptions.rows" [sortField]="datatableOptions.sortField"
             [sortOrder]="datatableOptions.sortOrder" [lazy]="true" (onLazyLoad)="onLazyLoad($event)"
             [responsive]="true" resizableColumns="true" selectionMode="single" [(selection)]="selectedJob"
             (onRowSelect)="onRowSelect($event)" [style]="{'min-height':'300px'}">
    <p-column field="job_type.name" header="Job Type" [filter]="true" filterMatchMode="equals" [sortable]="true"
              [style]="{'overflow':'visible'}">
        <ng-template pTemplate="filter" let-col>
            <p-dropdown [options]="jobTypeOptions" [(ngModel)]="selectedJobType" (onChange)="onJobTypeChange($event)"
                        [style]="{'width':'100%'}"
                        styleClass="ui-column-filter">
                <ng-template let-jobType p-template="item">
                    {{ jobType.label }}
                </ng-template>
            </p-dropdown>
        </ng-template>
        <ng-template let-col let-job="rowData" pTemplate="body">
            <span><i class="fa fa-fw" [innerHtml]="getUnicode(job.job_type.icon_code)"></i> {{job.job_type.title}} {{job.job_type
                .version}}</span>
        </ng-template>
    </p-column>
    <p-column field="created_formatted" header="Created" [sortable]="true"></p-column>
    <p-column field="last_modified_formatted" header="Last Modified" [sortable]="true"></p-column>
    <p-column field="duration" header="Duration"></p-column>
    <p-column field="status" header="Status" [filter]="true" filterMatchMode="equals" [sortable]="true" [style]="{'overflow':'visible'}">
        <ng-template pTemplate="filter" let-col>
            <p-dropdown [options]="statusValues" [(ngModel)]="selectedStatus" [style]="{'width':'100%'}" styleClass="ui-column-filter"
                        (onChange)="onStatusChange($event)"></p-dropdown>
        </ng-template>
    </p-column>
    <p-column field="error.category" header="Error Category" [filter]="true" filterMatchMode="equals" [sortable]="true" [style]="{'overflow':'visible'}">
        <ng-template pTemplate="filter" let-col>
            <p-dropdown [options]="errorCategoryValues" [(ngModel)]="selectedErrorCategory" [style]="{'width':'100%'}" styleClass="ui-column-filter"
                        (onChange)="onErrorCategoryChange($event)"></p-dropdown>
        </ng-template>
    </p-column>
    <p-column field="error.title" header="Error" [sortable]="true">
        <ng-template let-col let-job="rowData" pTemplate="body">
            <div *ngIf="job.error" pTooltip="{{ job.error.description }}">{{ job.error.title }}</div>
        </ng-template>
    </p-column>
</p-dataTable>
<p-paginator [rows]="10" [first]="datatableOptions.first" [totalRecords]="count" (onPageChange)="paginate($event)"></p-paginator>
