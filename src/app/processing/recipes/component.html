<h2>Recipes</h2>
<div class="recipes__date-filter">
    <div>
        <label>From:</label>
        <utc-datepicker [date]="started" [button]="true" (dateChange)="onStartSelect($event)"></utc-datepicker>
    </div>
    <div>
        <label>To:</label>
        <utc-datepicker [date]="ended" [button]="true" (dateChange)="onEndSelect($event)"></utc-datepicker>
    </div>
</div>
<p-dataTable [value]="recipes" [rows]="datatableOptions.rows" [sortField]="datatableOptions.sortField"
             [sortOrder]="datatableOptions.sortOrder" [lazy]="true" (onLazyLoad)="onLazyLoad($event)" [responsive]="true"
             resizableColumns="true" selectionMode="single" [(selection)]="selectedRecipe" [loading]="datatableLoading"
             (onRowSelect)="onRowSelect($event)" [style]="{'min-height':'300px'}">
    <p-column field="type.name" header="Recipe Type" [filter]="true" filterMatchMode="equals" [sortable]="true">
        <ng-template pTemplate="filter">
            <p-dropdown [options]="recipeTypeOptions" [(ngModel)]="selectedRecipeType" (onChange)="onChange($event)"
                        [autoWidth]="false" styleClass="ui-column-filter" appendTo="body">
                <ng-template let-recipeType p-template="item">
                    {{ recipeType.label }}
                </ng-template>
            </p-dropdown>
        </ng-template>
        <ng-template let-recipe="rowData" pTemplate="body">
            {{ recipe.recipe_type.title }} {{ recipe.recipe_type.version }}
        </ng-template>
    </p-column>
    <p-column field="created" header="Created (Z)" [sortable]="true">
        <ng-template let-recipe="rowData" pTemplate="body">
            {{ recipe.created_formatted }}
        </ng-template>
    </p-column>
    <p-column field="last_modified" header="Last Modified (Z)" [sortable]="true">
        <ng-template let-recipe="rowData" pTemplate="body">
            {{ recipe.last_modified_formatted }}
        </ng-template>
    </p-column>
    <p-column field="duration" header="Duration"></p-column>
    <p-column field="completed" header="Completed (Z)" [sortable]="true">
        <ng-template let-recipe="rowData" pTemplate="body">
            {{ recipe.completed_formatted }}
        </ng-template>
    </p-column>
</p-dataTable>
<p-paginator [rows]="datatableOptions.rows" [first]="datatableOptions.first" [totalRecords]="count" [rowsPerPageOptions]="[10,20,50,100]"
             (onPageChange)="paginate($event)"></p-paginator>
